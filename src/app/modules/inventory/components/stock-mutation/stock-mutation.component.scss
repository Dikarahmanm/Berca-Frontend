// ===== STOCK MUTATION COMPONENT - CLEAN SIMPLE DESIGN (PROPER) =====
// Toko Eniwan POS - Professional, Clean, High Contrast, Orange Theme

// Component-specific variables following Toko Eniwan POS design system
:host {
  display: block;
  width: 100%;
  
  // ⚠️ IMPORTANT: Toko Eniwan POS Brand Colors (SOLID)
  --primary: #FF914D !important;          // Toko Eniwan Orange
  --primary-hover: #E07A3B !important;    // Darker orange for hover
  --primary-light: #FFF4EF !important;    // Light orange background
  --success: #4BBF7B !important;          // Success green
  --warning: #FFB84D !important;          // Warning amber
  --error: #E15A4F !important;            // Error red
  --info: #3B82F6 !important;             // Info blue
  
  // Surface colors (ALL SOLID - NO TRANSPARENCY)
  --surface: #FFFFFF !important;          // Pure white cards
  --bg: #F8F9FA !important;               // Light gray background
  --bg-secondary: #F3F4F6 !important;     // Secondary background
  
  // Text colors (HIGH CONTRAST)
  --text: #212529 !important;             // Almost black
  --text-secondary: #6C757D !important;   // Gray text
  --text-muted: #ADB5BD !important;       // Muted text
  
  // Borders & shadows
  --border: #DEE2E6 !important;           // Light border
  --border-medium: #CED4DA !important;    // Medium border
  --shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);
  
  // Spacing (8px grid system)
  --s1: 4px; --s2: 8px; --s3: 12px; --s4: 16px;
  --s5: 20px; --s6: 24px; --s8: 32px; --s10: 40px;
  --s12: 48px; --s16: 64px;
  
  // Typography scale
  --text-xs: 12px; --text-sm: 14px; --text-base: 16px;
  --text-lg: 18px; --text-xl: 20px; --text-2xl: 24px;
  --text-3xl: 30px;
  
  // Transitions & effects
  --transition: 200ms ease;
  --transition-fast: 150ms ease;
  --radius: 8px;
  --radius-lg: 12px;
}

// ===== MAIN CONTAINER =====
.stock-mutation-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: var(--s6);
  background: var(--bg);
  min-height: 100vh;
  
  @media (max-width: 768px) {
    padding: var(--s4);
  }
}

// ===== HEADER SECTION =====
.mutation-header {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: var(--s6);
  margin-bottom: var(--s6);
  box-shadow: var(--shadow);
  
  .header-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--s4);
    
    @media (max-width: 768px) {
      flex-direction: column;
      align-items: stretch;
      gap: var(--s4);
    }
  }
  
  .title-section {
    display: flex;
    align-items: center;
    gap: var(--s4);
    
    .back-button {
      width: 44px;
      height: 44px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: var(--surface);
      color: var(--text-secondary);
      transition: var(--transition-fast);
      
      &:hover {
        background: var(--primary);
        border-color: var(--primary);
        color: white;
      }
    }
    
    .title-content {
      .page-title {
        display: flex;
        align-items: center;
        gap: var(--s3);
        margin: 0;
        font-size: var(--text-2xl);
        font-weight: 600;
        color: var(--text);
        line-height: 1.2;
        
        .title-icon {
          color: var(--primary);
          font-size: 28px;
        }
      }
      
      .page-subtitle {
        margin: var(--s2) 0 0 0;
        font-size: var(--text-base);
        color: var(--text-secondary);
        font-weight: 500;
      }
    }
  }
  
  .header-actions {
    .product-info-chip {
      display: flex;
      align-items: center;
      gap: var(--s2);
      padding: var(--s3) var(--s4);
      background: var(--primary-light);
      border: 1px solid var(--primary);
      border-radius: var(--radius);
      font-size: var(--text-sm);
      font-weight: 600;
      color: var(--primary);
      
      mat-icon {
        font-size: 18px;
      }
    }
  }
}

// ===== LOADING STATE =====
.loading-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: var(--s12);
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
  text-align: center;
  
  mat-spinner {
    margin-bottom: var(--s6);
  }
  
  p {
    color: var(--text-secondary);
    font-size: var(--text-base);
    margin: 0;
  }
}

// ===== MAIN CONTENT =====
.main-content {
  display: flex;
  flex-direction: column;
  gap: var(--s6);
}

// ===== CARD COMPONENT =====
.card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
  overflow: hidden;
  
  .card-header {
    padding: var(--s5) var(--s6);
    border-bottom: 1px solid var(--border);
    background: var(--bg-secondary);
    
    h2 {
      display: flex;
      align-items: center;
      gap: var(--s3);
      margin: 0;
      font-size: var(--text-lg);
      font-weight: 600;
      color: var(--text);
      
      mat-icon {
        color: var(--primary);
        font-size: 20px;
      }
    }
  }
  
  .card-content {
    padding: var(--s6);
  }
}

// ===== PRODUCT SUMMARY =====
.product-summary {
  .card-content {
    display: grid;
    gap: var(--s8);
    
    @media (min-width: 768px) {
      grid-template-columns: 1fr 2fr;
    }
  }
  
  .product-details {
    display: flex;
    flex-direction: column;
    gap: var(--s5);
    
    .detail-item {
      display: flex;
      flex-direction: column;
      gap: var(--s2);
      
      .detail-label {
        font-size: var(--text-xs);
        color: var(--text-secondary);
        text-transform: uppercase;
        font-weight: 600;
        letter-spacing: 0.5px;
      }
      
      .detail-value {
        font-size: var(--text-base);
        color: var(--text);
        font-weight: 500;
      }
    }
  }
  
  .stock-overview {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--s4);
    
    @media (max-width: 768px) {
      grid-template-columns: 1fr;
    }
  }
  
  .stock-card {
    display: flex;
    align-items: center;
    gap: var(--s4);
    padding: var(--s5);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    background: var(--surface);
    transition: var(--transition-fast);
    
    &:hover {
      border-color: var(--primary);
      box-shadow: 0 4px 12px rgba(255, 145, 77, 0.15);
    }
    
    .stock-icon {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      
      mat-icon {
        font-size: 24px;
      }
      
      &.warning {
        background: var(--warning);
      }
      
      &.value {
        background: var(--success);
      }
    }
    
    .stock-info {
      flex: 1;
      
      .stock-amount {
        font-size: var(--text-xl);
        font-weight: 700;
        color: var(--text);
        line-height: 1.2;
      }
      
      .stock-label {
        font-size: var(--text-xs);
        color: var(--text-secondary);
        text-transform: uppercase;
        font-weight: 600;
        letter-spacing: 0.5px;
        margin: var(--s1) 0 var(--s2) 0;
      }
      
      .stock-status {
        font-size: var(--text-xs);
        color: var(--text-muted);
      }
    }
  }
}

// ===== CONTENT TABS =====
.content-tabs {
  .mutation-tabs {
    ::ng-deep {
      .mat-mdc-tab-header {
        background: var(--bg-secondary);
        border-bottom: 1px solid var(--border);
        
        .mat-mdc-tab-label {
          min-width: 160px;
          padding: var(--s4) var(--s6);
          
          .mat-mdc-tab-label-content {
            display: flex;
            align-items: center;
            gap: var(--s2);
            font-weight: 500;
            
            mat-icon {
              font-size: 18px;
            }
          }
        }
        
        .mat-mdc-tab-label-active {
          .mat-mdc-tab-label-content {
            color: var(--primary);
            font-weight: 600;
          }
        }
        
        .mat-ink-bar {
          background-color: var(--primary);
          height: 3px;
        }
      }
      
      .mat-mdc-tab-body-wrapper {
        padding: 0;
      }
    }
  }
  
  .tab-content {
    padding: var(--s6);
    
    @media (max-width: 768px) {
      padding: var(--s5);
    }
  }
}

// ===== QUICK ACTIONS =====
.quick-actions {
  margin-bottom: var(--s6);
  
  h3 {
    margin: 0 0 var(--s5) 0;
    font-size: var(--text-lg);
    font-weight: 600;
    color: var(--text);
  }
  
  .action-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: var(--s4);
    
    @media (max-width: 768px) {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .quick-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--s2);
      padding: var(--s4) var(--s5);
      border-radius: var(--radius);
      font-weight: 500;
      transition: var(--transition-fast);
      min-height: 48px;
      
      &:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }
      
      &.stock-in {
        border-color: var(--success);
        color: var(--success);
        
        &:hover:not(:disabled) {
          background: var(--success);
          color: white;
          transform: translateY(-2px);
          box-shadow: 0 4px 12px rgba(75, 191, 123, 0.3);
        }
      }
      
      &.stock-out {
        border-color: var(--error);
        color: var(--error);
        
        &:hover:not(:disabled) {
          background: var(--error);
          color: white;
          transform: translateY(-2px);
          box-shadow: 0 4px 12px rgba(225, 90, 79, 0.3);
        }
      }
      
      &.adjustment {
        border-color: var(--warning);
        color: var(--warning);
        
        &:hover:not(:disabled) {
          background: var(--warning);
          color: white;
          transform: translateY(-2px);
          box-shadow: 0 4px 12px rgba(255, 184, 77, 0.3);
        }
      }
      
      mat-icon {
        font-size: 20px;
      }
    }
  }
}

// ===== SECTION DIVIDER =====
.section-divider {
  margin: var(--s8) 0;
  border-color: var(--border);
}

// ===== STOCK FORM =====
.stock-form {
  display: flex;
  flex-direction: column;
  gap: var(--s8);
  
  .form-section {
    h3 {
      margin: 0 0 var(--s6) 0;
      font-size: var(--text-lg);
      font-weight: 600;
      color: var(--text);
    }
    
    .form-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--s5);
      
      @media (max-width: 768px) {
        grid-template-columns: 1fr;
        gap: var(--s4);
      }
      
      .full-width {
        grid-column: 1 / -1;
      }
    }
  }
}

// ===== FORM FIELD OVERRIDES =====
::ng-deep {
  .mat-mdc-form-field {
    .mat-mdc-text-field-wrapper {
      .mat-mdc-form-field-flex {
        .mat-mdc-form-field-infix {
          padding: var(--s4) 0;
        }
      }
      
      .mdc-notched-outline {
        .mdc-notched-outline__leading,
        .mdc-notched-outline__notch,
        .mdc-notched-outline__trailing {
          border-color: var(--border);
          border-width: 1px;
        }
      }
      
      &:hover .mdc-notched-outline {
        .mdc-notched-outline__leading,
        .mdc-notched-outline__notch,
        .mdc-notched-outline__trailing {
          border-color: var(--primary);
        }
      }
    }
    
    &.mat-focused .mat-mdc-text-field-wrapper .mdc-notched-outline {
      .mdc-notched-outline__leading,
      .mdc-notched-outline__notch,
      .mdc-notched-outline__trailing {
        border-color: var(--primary);
        border-width: 2px;
      }
    }
    
    .mat-mdc-form-field-subscript-wrapper {
      .mat-mdc-form-field-hint-wrapper,
      .mat-mdc-form-field-error-wrapper {
        padding: 0;
        margin-top: var(--s2);
      }
    }
  }
}

// ===== MUTATION OPTION =====
.mutation-option {
  display: flex;
  align-items: center;
  gap: var(--s3);
  
  mat-icon {
    font-size: 18px;
  }
}

// ===== PREVIEW SECTION =====
.preview-section {
  .preview-card {
    border: 1px solid var(--border);
    border-radius: var(--radius);
    overflow: hidden;
    background: var(--bg-secondary);
    
    .preview-header {
      display: flex;
      align-items: center;
      gap: var(--s3);
      padding: var(--s4) var(--s5);
      background: var(--surface);
      border-bottom: 1px solid var(--border);
      font-size: var(--text-base);
      font-weight: 600;
      color: var(--text);
      
      mat-icon {
        font-size: 20px;
      }
    }
    
    .preview-content {
      padding: var(--s5);
      
      .preview-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: var(--s5);
        
        @media (max-width: 768px) {
          grid-template-columns: repeat(2, 1fr);
          gap: var(--s4);
        }
      }
      
      .preview-item {
        display: flex;
        flex-direction: column;
        gap: var(--s2);
        
        .preview-label {
          font-size: var(--text-xs);
          color: var(--text-secondary);
          text-transform: uppercase;
          font-weight: 600;
          letter-spacing: 0.5px;
        }
        
        .preview-value {
          font-size: var(--text-xl);
          font-weight: 700;
          color: var(--text);
          
          &.current {
            color: var(--primary);
          }
          
          &.new {
            color: var(--success);
          }
          
          &.cost {
            color: var(--warning);
          }
        }
      }
    }
  }
}

// ===== FORM ACTIONS =====
.form-actions {
  display: flex;
  justify-content: flex-end;
  gap: var(--s4);
  padding-top: var(--s6);
  border-top: 1px solid var(--border);
  
  @media (max-width: 768px) {
    flex-direction: column;
    
    .action-btn {
      width: 100%;
    }
  }
  
  .action-btn {
    display: flex;
    align-items: center;
    gap: var(--s2);
    padding: var(--s4) var(--s6);
    border-radius: var(--radius);
    font-weight: 500;
    min-height: 44px;
    transition: var(--transition-fast);
    
    &.secondary {
      border-color: var(--border);
      color: var(--text-secondary);
      
      &:hover:not(:disabled) {
        background: var(--bg-secondary);
        border-color: var(--primary);
        color: var(--primary);
      }
    }
    
    &.primary {
      &:hover:not(:disabled) {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(255, 145, 77, 0.3);
      }
    }
    
    mat-icon {
      font-size: 18px;
    }
    
    mat-spinner {
      margin-right: var(--s2);
    }
  }
}

// ===== HISTORY FILTERS =====
.history-filters {
  margin-bottom: var(--s6);
  
  .filter-form {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: var(--s5);
    
    @media (max-width: 768px) {
      grid-template-columns: 1fr;
      gap: var(--s4);
    }
  }
}

// ===== HISTORY TABLE =====
.history-table-container {
  .loading-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: var(--s10);
    text-align: center;
    
    mat-spinner {
      margin-bottom: var(--s5);
    }
    
    p {
      color: var(--text-secondary);
      margin: 0;
      font-size: var(--text-base);
    }
  }
  
  .table-wrapper {
    border: 1px solid var(--border);
    border-radius: var(--radius);
    overflow: hidden;
    background: var(--surface);
    
    .history-table {
      width: 100%;
      
      ::ng-deep {
        .mat-mdc-table {
          background: var(--surface);
        }
        
        .mat-mdc-header-row {
          background: var(--bg-secondary);
          
          .mat-mdc-header-cell {
            font-size: var(--text-xs);
            font-weight: 700;
            color: var(--text);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: var(--s4) var(--s5);
            border-bottom: 1px solid var(--border);
          }
        }
        
        .mat-mdc-row {
          &:hover {
            background: var(--bg-secondary);
          }
          
          .mat-mdc-cell {
            padding: var(--s4) var(--s5);
            font-size: var(--text-sm);
            color: var(--text);
            border-bottom: 1px solid var(--border);
          }
        }
      }
      
      .date-cell {
        white-space: nowrap;
        min-width: 140px;
        font-weight: 500;
      }
      
      .type-chip {
        font-size: var(--text-xs);
        font-weight: 600;
        padding: var(--s1) var(--s3);
        border-radius: var(--radius);
        
        ::ng-deep {
          .mat-mdc-chip-avatar {
            margin-left: 0;
            margin-right: var(--s1);
          }
        }
      }
      
      .quantity-cell {
        font-weight: 600;
        
        .positive {
          color: var(--success);
        }
        
        .negative {
          color: var(--error);
        }
      }
      
      .notes-cell {
        max-width: 200px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      
      .reference-cell {
        color: var(--text-secondary);
        font-style: italic;
      }
      
      .created-by-cell {
        color: var(--text-secondary);
        font-weight: 500;
      }
    }
  }
  
  .empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: var(--s12);
    text-align: center;
    border: 1px solid var(--border);
    border-radius: var(--radius);
    background: var(--surface);
    
    .empty-icon {
      font-size: 64px;
      color: var(--text-muted);
      margin-bottom: var(--s5);
    }
    
    h3 {
      margin: 0 0 var(--s3) 0;
      font-size: var(--text-xl);
      font-weight: 600;
      color: var(--text);
    }
    
    p {
      margin: 0;
      color: var(--text-secondary);
      font-size: var(--text-base);
    }
  }
  
  .history-paginator {
    ::ng-deep {
      .mat-mdc-paginator {
        background: var(--bg-secondary);
        border-top: 1px solid var(--border);
        
        .mat-mdc-paginator-range-label {
          color: var(--text-secondary);
        }
        
        .mat-mdc-icon-button {
          color: var(--text-secondary);
          
          &:hover {
            color: var(--primary);
            background: var(--primary-light);
          }
          
          &[disabled] {
            color: var(--text-muted);
          }
        }
      }
    }
  }
}

// ===== RESPONSIVE ADJUSTMENTS =====
@media (max-width: 768px) {
  .stock-mutation-container {
    .mutation-header {
      .header-content {
        .title-section {
          .title-content {
            .page-title {
              font-size: var(--text-xl);
            }
          }
        }
      }
    }
    
    .product-summary {
      .card-content {
        grid-template-columns: 1fr;
        gap: var(--s6);
      }
      
      .stock-overview {
        grid-template-columns: 1fr;
      }
    }
    
    .quick-actions {
      .action-grid {
        grid-template-columns: 1fr;
      }
    }
    
    .history-table-container {
      .table-wrapper {
        overflow-x: auto;
        
        .history-table {
          min-width: 800px;
        }
      }
    }
  }
}

// ===== ACCESSIBILITY =====
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

// ===== FOCUS STYLES =====
button:focus,
.mat-mdc-button:focus,
.mat-mdc-outlined-button:focus,
.mat-mdc-raised-button:focus {
  outline: 2px solid var(--primary);
  outline-offset: 2px;
}

// ===== PRINT STYLES =====
@media print {
  .stock-mutation-container {
    .mutation-header,
    .quick-actions,
    .form-actions,
    .history-paginator {
      display: none;
    }
    
    .card {
      border: 1px solid #000;
      page-break-inside: avoid;
      margin-bottom: 20px;
      box-shadow: none;
    }
    
    .history-table {
      .mat-mdc-header-cell,
      .mat-mdc-cell {
        border: 1px solid #000;
        padding: 8px;
      }
    }
  }
}